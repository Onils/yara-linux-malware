rule meterpreter_linux_x64_reverse_tcp_staged:RAT binary metasploit {
    meta:
        name = "meterpreter linux x64 tcp staged"
        author = "lonils"
        description = "/linux/x64/meterpreter/reverse_tcp"
    strings: 
        $sys_mmap_rwx = {4831 ff6a 0958 99b6 1048 89d6 4d31 c96a 2241 5ab2 070f 05} 
        $sys_socket_stream = { 6a?? 4159 506a 2958 996a 025f 6a01 5e0f 05}
    condition:
        uint16 ( 0 ) == 0x457f and all of them and filesize < 1KB
}

