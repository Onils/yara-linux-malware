rule metasploit_linux_x64_bin_sh:RAT binary metasploit {
    meta:
        name = "meterpreter linux x64 bin sh"
        author = "lonils"
        info = "linux/x64/exec | linux/x64/meterpreter/reverse_tcp | "
    strings: 
        $movabs_xxx_bin_sh = {48?? 2f62 696e 2f73 6800}
        $movabs_xxx_slash_bin_sh = {48?? 2f2f 6269 6e2f 7368}
        $mov_xxx_bin_sh = {b?41 2f73 68b? 2f62 696e}

    condition:
        uint16 ( 0 ) == 0x457f and filesize < 1KB and 1 of them
}

